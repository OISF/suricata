#!/bin/bash

#DEBHELPER#

# Remove old core files generated by a previous version of Suricata...
for dir in /core /var/crash /var/lib/systemd/coredump
do
    for file in $(ls $dir/* 2>/dev/null)
    do 
        if $(file $file | grep -qP ".*core file x86-64.*/opt/suricata6/bin/suricata")
        then 
            echo "removing $file"
            rm $file
        else 
            echo "not removing $file"
        fi
    done
done
